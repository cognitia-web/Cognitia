<!-- App Loader (shows until ready) -->
<app-loader [isLoading]="!isAppReady()"></app-loader>

<!-- Premium Animated Background -->
<app-animated-background></app-animated-background>

<!-- Toast Notifications -->
<app-toast-container></app-toast-container>

<!-- Command Palette -->
<app-command-palette></app-command-palette>

<!-- Floating Navigation (Tim Cook spec) -->
<app-floating-nav *ngIf="showNav && isAuthenticated"></app-floating-nav>

<!-- Top Navigation (keep for non-authenticated pages) -->
<nav *ngIf="showNav && isAuthenticated" class="fixed top-0 left-0 right-0 z-50 backdrop-blur-2xl bg-white/70 dark:bg-gray-900/70 border-b border-white/20 dark:border-gray-700/20 shadow-2xl shadow-purple-500/10">
  <div class="container mx-auto px-6">
    <div class="flex justify-between items-center h-20">
      <!-- Logo with 3D Effect -->
      <div class="flex items-center space-x-4 group cursor-pointer">
        <div class="relative">
          <div class="absolute inset-0 bg-gradient-to-br from-purple-600 to-pink-600 rounded-2xl blur-lg opacity-75 group-hover:opacity-100 transition-all duration-300 animate-pulse-slow"></div>
          <div class="relative w-12 h-12 bg-gradient-to-br from-purple-600 to-pink-600 rounded-2xl flex items-center justify-center shadow-2xl transform group-hover:scale-110 group-hover:rotate-6 transition-all duration-300">
            <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
            </svg>
          </div>
        </div>
        <div>
          <span class="text-2xl font-black bg-gradient-to-r from-purple-600 via-pink-600 to-purple-600 bg-clip-text text-transparent animate-gradient">Cognitia</span>
          <p class="text-xs text-gray-500 dark:text-gray-400 font-medium">AI-Powered Learning</p>
        </div>
      </div>
      
      <!-- Desktop Navigation with Modern Pills -->
      <div class="hidden md:flex items-center space-x-2 bg-white/50 dark:bg-gray-800/50 rounded-full p-2 backdrop-blur-xl border border-white/20 dark:border-gray-700/20">
        <a routerLink="/chat" routerLinkActive="nav-active" 
           class="nav-pill group">
          <svg class="w-5 h-5 transition-transform group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
          </svg>
          <span class="font-semibold">Chat</span>
        </a>
        <a routerLink="/todo" routerLinkActive="nav-active"
           class="nav-pill group">
          <svg class="w-5 h-5 transition-transform group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path>
          </svg>
          <span class="font-semibold">Tasks</span>
        </a>
        <a routerLink="/timetable" routerLinkActive="nav-active"
           class="nav-pill group">
          <svg class="w-5 h-5 transition-transform group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
          </svg>
          <span class="font-semibold">Schedule</span>
        </a>
        <a routerLink="/flashcards" routerLinkActive="nav-active"
           class="nav-pill group">
          <svg class="w-5 h-5 transition-transform group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
          </svg>
          <span class="font-semibold">Cards</span>
        </a>
      </div>
      
      <!-- Action Buttons -->
      <div class="flex items-center space-x-3">
        <!-- Search Button -->
        <button class="p-3 rounded-xl bg-white/80 dark:bg-gray-800/80 hover:bg-white dark:hover:bg-gray-700 transition-all duration-300 transform hover:scale-110 shadow-lg hover:shadow-xl">
          <svg class="w-5 h-5 text-gray-700 dark:text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
        </button>
        
        <!-- Notifications -->
        <button class="relative p-3 rounded-xl bg-white/80 dark:bg-gray-800/80 hover:bg-white dark:hover:bg-gray-700 transition-all duration-300 transform hover:scale-110 shadow-lg hover:shadow-xl">
          <svg class="w-5 h-5 text-gray-700 dark:text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
          </svg>
          <span class="absolute top-2 right-2 w-2 h-2 bg-pink-500 rounded-full animate-ping"></span>
          <span class="absolute top-2 right-2 w-2 h-2 bg-pink-500 rounded-full"></span>
        </button>
        
        <!-- Profile -->
        <button class="flex items-center space-x-2 p-2 pr-4 rounded-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl">
          <div class="w-8 h-8 rounded-full bg-white/20 flex items-center justify-center">
            <span class="text-white font-bold text-sm">Y</span>
          </div>
          <span class="text-white font-semibold text-sm">You</span>
        </button>
      </div>
    </div>
  </div>
</nav>

<!-- Main Content with Depth -->
<main [class.pt-24]="showNav && isAuthenticated" [class.pt-0]="!showNav || !isAuthenticated" class="min-h-screen relative">
  <!-- Breadcrumb -->
  <div *ngIf="showNav && isAuthenticated" class="container mx-auto px-6 pt-6">
    <app-breadcrumb></app-breadcrumb>
  </div>
  
  <router-outlet></router-outlet>
</main>

<!-- Premium Footer -->
<app-premium-footer *ngIf="showNav && isAuthenticated"></app-premium-footer>

<!-- Action Toggle Button (Sunrise - Tim Cook spec) -->
<app-action-toggle-button 
  *ngIf="showNav && isAuthenticated"
  style="position: fixed; bottom: 2rem; right: 6rem; z-index: 1000;">
</app-action-toggle-button>

<!-- FAB with Magnetic Effect -->
<app-fab
  *ngIf="showNav && isAuthenticated"
  class="fab-magnetic"
  [actions]="fabActions"
  (actionClicked)="onFabAction($event)">
</app-fab>


